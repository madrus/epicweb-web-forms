# Zod schema validation

## My Notes

Here is our definition of the Zod schema:

```tsx
const titleMaxLength = 100
const contentMaxLength = 10000

const NoteEditorSchema = z.object({
	title: z
		.string()
		.min(1, {
			message: 'Title is required',
		})
		.max(titleMaxLength, {
			message: `Title must be at most ${titleMaxLength} characters`,
		}),
	content: z
		.string()
		.min(1, {
			message: 'Content is required',
		})
		.max(contentMaxLength, {
			message: `Content must be at most ${contentMaxLength} characters`,
		}),
})
```

Notice that requiring a non-empty value of the title and content is done by specifying `min(1)`
as an empty string is considered as a valid value by Zod.

Also, we can add our own custom error messages although it is optional. Zod has its own
default error messages. I think that custom messages would definitely be useful
in a multi-language setting.

## KCD's Workshop

<EpicVideo url="https://www.epicweb.dev/workshops/professional-web-forms/schema-validation/schema-validation" />

🧝‍♂️ BTW, I swapped your `useEffect` for a custom `useFocusInvalid` hook, just so
you know.

👨‍💼 Let's make our validation better and more declarative. Prepare to delete a
lot of code!

One important thing you'll want to know is how Zod manages errors. When you use
`zodSchema.parse`, it will throw an error if the data is invalid. If you use
`zodSchema.safeParse`, it will return an object with a `success` property that
tells you whether the data is valid or not. If it's not valid, it will also
have an `error` property that contains the error object. If it is valid, it
will have a `data` property that contains the parsed data.

The [Error Handling](https://zod.dev/ERROR_HANDLING) docs can be quite helpful.
You'll definitely want to use
[`.flatten`](https://zod.dev/ERROR_HANDLING?id=flattening-errors) for this one:

```tsx
if (!result.success) {
	console.log(result.error.flatten())
}
/*
  {
    formErrors: [],
    fieldErrors: {
      name: ['Expected string, received null'],
      contactInfo: ['Invalid email']
    },
  }
*/
```

That shape may look a little familiar 😅

That should be enough to get you going.

- [📜 Zod docs](https://zod.dev)
- [📜 Zod Error Handling](https://zod.dev/ERROR_HANDLING)
- [📜 Zod Flattening Errors](https://zod.dev/ERROR_HANDLING?id=flattening-errors)
